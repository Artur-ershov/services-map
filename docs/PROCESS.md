# Процесс работы с проектом

## Синхронизация данных

### Google Sheets → data.js (рекомендуется)

1. Обновите данные в Google Sheets
2. Запустите синхронизацию:
   ```bash
   python scripts/sync-csv-to-data.py
   ```
   
   Скрипт автоматически загрузит данные из Google Sheets.
3. Проверьте `data-generated.js`
4. Если всё корректно, переименуйте в `data.js` (сделайте бэкап!)

### Локальный CSV → data.js (альтернатива)

1. Обновите CSV файл в папке `data/`
2. Запустите синхронизацию:
   ```bash
   python scripts/sync-csv-to-data.py data/table.csv
   ```
   
   Или скрипт автоматически найдет CSV файл в папке `data/`.
3. Проверьте `data-generated.js`
4. Если всё корректно, переименуйте в `data.js` (сделайте бэкап!)

### Важные правила

**Колонка `id` в CSV = `areaId` в data.js = `id` в SVG**

Эти значения должны точно совпадать для работы интерактивности на карте.

Пример:
- CSV: `id = "b1f1-coffee"`
- SVG: `<g id="b1f1-coffee">`
- data.js: `areaId: "b1f1-coffee"`

## Структура проекта

### Файлы данных
- `data.js` - основной файл с данными сервисов (генерируется из CSV)
- `data/карта сервисов рабочая таблица.xlsx - Sheet1 (3).csv` - источник данных

### SVG карты
- `map/*.svg` - SVG файлы этажей
- ID групп в SVG должны совпадать с `id` в CSV

### Скрипты
- `scripts/sync-csv-to-data.py` - синхронизация CSV → data.js
- `scripts/generate-svg-floor-plans.py` - генерация `svgFloorPlans` из SVG файлов

### Документация
- `docs/SVG_PROCESSING.md` - правила обработки SVG (решение проблемы "черных квадратов")
- `docs/FILE_STRUCTURE.md` - структура файлов
- `.cursor/ARCHITECTURE_DISCUSSIONS.md` - архитектурные обсуждения (internal)
- `README.md` - основная документация

## Чеклист перед коммитом

- [ ] CSV синхронизирован: запущен `sync-csv-to-data.py`
- [ ] Проверено в браузере: карты отображаются без черных квадратов
- [ ] Проверены все корпуса (B1, B2, B3) и этажи
- [ ] `areaId` в data.js совпадают с `id` в SVG
- [ ] `tmp.css` не удален (нужен для локального просмотра шрифта)

## Известные проблемы и решения

### "Черные квадраты" на карте
**Решение:** См. `SVG_PROCESSING.md` - рекурсивная установка `fill="none"` для элементов без `fill`.

### Сервисы не отображаются на карте
**Проверка:** Убедитесь, что `areaId` в data.js совпадает с `id` в SVG группах.

### Карты не загружаются
**Проверка:** 
1. Существуют ли SVG файлы в `map/`
2. Заполнен ли `svgFloorPlans` в data.js
3. Правильные ли ключи формата `B1-F1`, `B2-F1` и т.д.

## Удаленные компоненты

Следующие компоненты были удалены как неиспользуемые:
- ❌ Figma интеграции (экспорт/синхронизация)
- ❌ Скрипты для работы с Figma API
- ❌ Генерация `figma-mapping.csv`

**Причина:** SVG файлы уже загружены, Figma интеграция не нужна.

